Feature: OptionalHeaderWindowsSpecificPE32
	In order to dissect a PECOFF binary file
	As an interested party
	I want to read the OptionalHeaderWindowsSpecificPE32 from the file
	And I want to see the component parts

Scenario Outline: Read the OptionalHeaderWindowsSpecificPE32 from a given PECOFF binary file
	Given a PECOFF binary file named <File Name>
	When I read in the MSDOS20Section
	And I read in the OptionalHeaderWindowsSpecificPE32
	Then the BaseOfData shoud be <BaseOfData>
	And the ImageBase should be <ImageBase>
	And the SectionAlignment should be <SectionAlignment>
	And the FileAlignment should be <FileAlignment>
	And the MajorOperatingSystemVersion should be <MajorOperatingSystemVersion>
	And the MinorOperatingSystemVersion should be <MinorOperatingSystemVersion>
	And the MajorImageVersion should be <MajorImageVersion>
	And the MinorImageVersion should be <MinorImageVersion>
	And the MajorSubsystemVersion should be <MajorSubsystemVersion>
	And the MinorSubsystemVersion should be <MinorSubsystemVersion>
	And the Win32VersionValue should be <Win32VersionValue>
	And the SizeOfImage should be <SizeOfImage>
	And the SizeOfHeaders should be <SizeOfHeaders>
	And the CheckSum should be <CheckSum>
	And the Subsystem should be <Subsystem>
	And the DllCharacteristics should be <DllCharacteristics>
	And the SizeOfStackReserve should be <SizeOfStackReserve>
	And the SizeOfStackCommit should be <SizeOfStackCommit>
	And the SizeOfHeapReserve should be <SizeOfHeapReserve>
	And the SizeOfHeapCommit should be <SizeOfHeapCommit>
	And the LoaderFlags should be <LoaderFlags>
	And the NumberOfRvaAndSizes should be <NumberOfRvaAndSizes>

Examples: 
	| File Name                        | BaseOfData | ImageBase | SectionAlignment | FileAlignment | MajorOperatingSystemVersion | MinorOperatingSystemVersion | MajorImageVersion | MinorImageVersion | MajorSubsystemVersion | MinorSubsystemVersion | Win32VersionValue | SizeOfImage | SizeOfHeaders | CheckSum | Subsystem | DllCharacteristics | SizeOfStackReserve | SizeOfStackCommit | SizeOfHeapReserve | SizeOfHeapCommit | LoaderFlags | NumberOfRvaAndSizes |
	| HelloWorld_CSC_2.0.exe           | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_CSC_3.5.exe           | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_CSC_4.0.exe           | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_2.0.exe            | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_3.0.exe            | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_3.5.exe            | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_4.5.1.exe          | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 6                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8560             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_4.5.2.exe          | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 6                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8560             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_4.5.exe            | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 6                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8560             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_4.6.1.exe          | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 6                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8560             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_4.6.2.exe          | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 6                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8560             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_4.6.exe            | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 6                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8560             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_4.exe              | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_VS_Core_1.0.dll       | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_2.0.exe       | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_4.0.exe       | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_4.0Client.exe | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_4.5.1.exe     | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_4.5.2.exe     | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_4.5.exe       | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_4.6.1.exe     | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |
	| HelloWorld_Xamarin_4.6.exe       | 0x4000     | 0x400000  | 0x2000           | 0x200         | 4                           | 0                           | 0                 | 0                 | 4                     | 0                     | 0                 | 32768       | 512           | 0x0      | 0x3       | 0x8540             | 1048576            | 4096              | 1048576           | 4096             | 0x0         | 0x10                |

